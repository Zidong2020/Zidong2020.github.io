
<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Zidong Xu - YOLOv5 & Time series analysis</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">

        <!--Google fonts links-->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">


        <link rel="stylesheet" href="assets/css/fonticons.css">
        <link rel="stylesheet" href="assets/css/slider-pro.css">
        <!--<link rel="stylesheet" href="assets/css/stylesheet.css">-->
        <link rel="stylesheet" href="assets/css/font-awesome.min.css">
        <link rel="stylesheet" href="assets/css/bootstrap.min.css">


        <!--For Plugins external css-->
        <link rel="stylesheet" href="assets/css/plugins.css" />

        <!--Theme custom css -->
        <link rel="stylesheet" href="assets/css/style.css">

        <!--Theme Responsive css-->
        <link rel="stylesheet" href="assets/css/responsive.css" />

        <script src="assets/js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
        <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    </head>

    <body data-spy="scroll" data-target=".navbar-collapse">
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        
        <div class='preloader'><div class='loaded'>&nbsp;</div></div>

        <!--Navigation bar-->
        <div id="nav-placeholder">
            
        </div>

        <script>
        $(function(){
          $("#nav-placeholder").load("nav.html");
        });
        </script>
        <!--end of Navigation bar-->



        <!-- Blog Section -->
        <section id="bloginner" class="bloginner sections margin-top-120">
            <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="head_title text-center">
                            <h3>YOLOv5 & Time series analysis </h3>

                            <h5>11 December 2022</h5>
                            Authors: Zidong Xu

                        </div><!-- End of head title -->
                        <div class="main_bloginner_area">
                            <div class="row">
                                <div class="col-sm-10 col-sm-offset-1">
                                    <div class="main_bloginner_content">

                                      <table style="margin:auto;">
                                        <tr>
                                          <td>
                                            <div class="single_bloginner s_blogIner_1 text-center">
                                              <br>
                                              <img src="assets/images/dl-images/yolov5-logo.png" alt="" width="130" height="110"/>
                                            </div>
                                          </td>
                                    
                                          </td>
                                        </tr>
                                      </table>

                                       
                                        <div class="single_bloginner s_blogIner_2 margin-top-80">
                                            <div class="separator2"></div>
                                            <p><strong>Focus on... </strong>
                                            </p>

                                            <ul>
                                              <li>
                                                &#9749; EDA 
                                              </li>

                                              <li>
                                                &#9749; NLP (NLTK & Spark NLP)
                                              </li>

                                              <li>
                                                &#9749; Machine Learning Pipelines (Spark ML) <br>
                                                &nbsp; &nbsp; -- <strong>Random Forests </strong> & <strong>Logistic Regression </strong>

                                              </li>
                                          
                                              
                                            </ul>
                                            

                                        </div>

                                        <div class="single_bloginner s_blogIner_3 margin-top-60">
                                            <h4>Project Background</h4>
                                            <br>

                                            <p>How to better operate Reddit, it is very important to understand users, including understanding the topics they care about, understanding their usage habits and so on.
                                              The Word Cloud in the figure below uses NLTK to clean up the text output by the user.
                                              From the Word Cloud, we noticed that the topics that teenagers focus on mainly focus on school, family and emotion.
                                            </p>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12">
                                <div class="single_bloginner s_blogIner_4 single_bloginner_bottom_heading margin-top-80">
                                    <div class="separator2"></div>
                                     <h4>Tutorial </h4>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-10 col-sm-push-1">
                                    <div class="single_bloginner s_blogIner_5 margin-top-60">
                                       
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <div class="single_bloginner s_blogIner_1 text-center">
                                            <img src="assets/images/bigdata-images/submissions_first5.png" alt="" width="800" height="280"/>
                                            process pic...
                                          </div>
                                          <br><br>
                                          <strong>Pre-processing</strong>
                                        </h3>

                                            <br>
                                                <p>
                                                  &#9749; import vedio (.mp4) <br>
                                                  The video is 2hr8min55s which is 26060+8*60+55=7735 seconds <br>
                                                  The frame rate for the video is roughly 30 frames per second <br>
                                                  So there are around 7735*30=232050 frames <br>

                                                  &#9749; read and convert the video into an ORDERED set of images <br>
                                                  save frames every 50 seconds, that will be around 155 images <br>

                                                </p>

                                                <p style="background-color:rgb(237, 233, 233);">
                                                  <font size="-0.4" >
                                                  <code>
                                                    <strong># transform1: change utc to readable timestamp format </strong><br>
                                                    teenagers_comments = teenagers_comments.withColumn("created_time", to_timestamp(teenagers_comments["created_utc"])) <br><br>
                                                    <strong># transform2: extract hour part from  readable timestamp "created_time" </strong><br>
                                                    comments_hour = teenagers_comments.limit(1000000).toPandas()["created_time"].apply(lambda x: x.hour).to_frame() <br>
                                                   
                                                    
                                                  </code>
                                                  </font>
                
                                                </p>                                                               
                                                <hr>
                                     
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Explore the model </strong>
                                        </h3>
                                        <br>
                                        <p>
                                          Before processing the video data, we want to make sure we can get YOLO working correctly for a few images. <br>
                                        </p>

                                        <div class="single_bloginner s_blogIner_1 text-center">
                                          <img src="assets/images/dl-images/p1.png" alt="" width="400" height="240"/><br><br>
                                          Original image<br><br>
                                        </div>

                                        <p style="background-color:rgb(237, 233, 233);">
                                          <font size="-0.4" >
                                          <code>
                                            <strong># INSERT CODE TO LOAD THE YOLO MODEL USING PYTORCH </strong><br>
                                            model = torch.hub.load('ultralytics/yolov5', 'yolov5s') <br><br>
                                            <strong># AT FIRST USE THE FOLLOWING IMAGES AS A TEST CASE </strong><br>
                                            images=['frames/00050.jpg','frames/00200.jpg'] <br>
                                            <strong># INSERT CODE TO EVALUATE THE YOLO MODEL ON THESE IMAGES </strong><br>
                                            results = model(images) <br>
                                            results.show()<br>
 
                                          </code>
                                          </font>
                                        </p>   

                                        <div class="single_bloginner s_blogIner_1 text-center">
                                          <img src="assets/images/dl-images/p2.png" alt="" width="400" height="480"/><br><br>
                                          Images after process<br><br>
                                        </div>

                                        <p style="background-color:rgb(237, 233, 233);">
                                          <font size="-0.4" >
                                          <code>
                                            <strong>#THE INFORMATION ABOUT THE BOUNDING BOXES CAN BE EXTRACTED AS FOLLOWS </strong><br>
                                            print(results.pandas().xyxy[1])<br>
                                          </code>
                                          </font>
                                        </p> 

                                        <div class="single_bloginner s_blogIner_1 text-center">
                                          <img src="assets/images/dl-images/p3.png" alt="" width="600" height="450"/><br><br>
                                          Objects summary<br><br>
                                        </div>


                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Explore the model </strong>
                                        </h3>
                                        <br>
                                        <p>
                                          normalize (scale) the xmin, xmax by the width of the image and ymin, ymax by the height --> HxW=1x1 <br>
                                          compute the area and center of each box using the normalized coordinates <br>
                                          add a column named "nearby" which is True if normalized_area>0.05 <br>
                                        </p>

                                        <p style="background-color:rgb(237, 233, 233);">
                                          <font size="-0.4" >
                                          <code>
                                            def box_normalize(df): <br>
                                            &nbsp; YMAX=img.shape[0] <br>
                                            &nbsp; XMAX=img.shape[1] <br><br>
                                                
                                            &nbsp; df["xmin"] = (df["xmin"]/XMAX) <br>
                                            &nbsp; df["xmax"] = (df["xmax"]/XMAX) <br>
                                            &nbsp; df["ymin"] = (df["ymin"]/YMAX) <br>
                                            &nbsp; df["ymax"] = (df["ymax"]/YMAX) <br><br>

                                            &nbsp; df['area'] = (df["xmax"] - df["xmin"]) * (df["ymax"] - df["ymin"]) <br>
                                                
                                            &nbsp; df['area'] = np.where(df['area'] > 0.05, True, False) <br><br>

                                            &nbsp; return df <br><br>

                                            box_normalize(results.pandas().xyxy[0])<br>

                                          </code>

                                          <div class="single_bloginner s_blogIner_1 text-center">
                                            <img src="assets/images/dl-images/p4.png" alt="" width="600" height="120"/><br><br>
                                            
                                          </div>
                                          
                                          
                                        </h3>
                                        <br>

                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Time-series analysis </strong>
                                        </h3>

                                        <p>
                                        <h5><strong>Process all images ... </strong></h5>
                                          Loop over the results and build arrays with time-series data for the following: <br>
                                          The frames are ordered so we can treat the index as a "time" variables <br>
                                          Total number num_cars and num_trucks in each frame <br>
                                          num_neighbor = Number of neighboring cars and trucks (use normalized box area > .05 to signify a nearby car or truck) <br>
                                        </p>

                                        <p style="background-color:rgb(237, 233, 233);">
                                          <font size="-0.4" >
                                          <code>
                                            <strong># INSERT CODE TO LOOP OVER RESULTS AND BUILD ARRAYS </strong><br>
                                            num_cars = [] <br>
                                            num_trucks = [] <br>
                                            num_neighbor = [] <br>
                                            for i in range(0,len(results)): <br>
                                            &nbsp; temp = box_normalize(results.pandas().xyxy[i]) <br><br>

                                            &nbsp; car_count = (temp["name"] == "car").sum() <br>
                                            &nbsp; truck_count = (temp["name"] == "truck").sum() <br>
                                            &nbsp; neighbor_count = (temp["area"] == True).sum() <br><br>

                                            &nbsp; num_cars.append(car_count) <br>
                                            &nbsp; num_trucks.append(truck_count) <br>
                                            &nbsp; num_neighbor.append(neighbor_count) <br>
                                          </code>
                                          </font>
                                        </p>   

                                        <div class="single_bloginner s_blogIner_1 text-center">
                                          <img src="assets/images/dl-images/p5.png" alt="" width="600" height="60"/><br><br>
                                         
                                        </div>
                                        <div class="single_bloginner s_blogIner_1 text-center">
                                          <img src="assets/images/dl-images/p6.png" alt="" width="600" height="450"/><br><br>
                                         
                                        </div>
                                        <br>
                                        <hr>
                                    
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Conclusions</strong>
                                        </h3>
                                        <br>
                                        
                                        <p>
                                          In this blog, we first use Word Cloud to give an important impression about what the text says, then show how to use NLTK and spark NLP to do basic text cleaning and finally show how to use spark ML to build pipelines. Although we mention some business sense when analyzing data, we still need to consider more. If you are interested in this project, you can click the link below, our group mate analysis from other angles, or contact me directly through email.
                                        </p>
                                       
                                        <br>
                                        <hr>
                                       
                                        
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Links for more details</strong>
                                        </h3>
                                                <br>
                                                <ul>
                                                  <li>
                                                    Complete Project: <a href="https://gu-anly502.github.io/fall-2022-reddit-big-data-project-project-group-14/">Reddit Discussion on Teenagers</a> 
                                                  </li>
                                  
                                                </ul>
                                              
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><!-- End of col-sm-12 -->
                </div><!-- End of row -->
            </div><!-- End of Container -->
        </section><!-- End of Blog Section -->



        <div class='preloader'><div class='loaded'>&nbsp;</div></div>
        <!--Footer bar-->
        <div id="footer-placeholder">
          
        </div>

        <script>
        $(function(){
          $("#footer-placeholder").load("footer.html");
        });
        </script>
        <!--end of Footer bar-->

        

        <!-- START SCROLL TO TOP  -->

        <div class="scrollup">
            <a href="#"><i class="fa fa-chevron-up"></i></a>
        </div>

        <script src="assets/js/vendor/jquery-1.11.2.min.js"></script>
        <script src="assets/js/vendor/bootstrap.min.js"></script>

        <script src="assets/js/jquery.easing.1.3.js"></script>
        <script src="assets/js/masonry/masonry.min.js"></script>
        <script type="text/javascript">
            $('.mixcontent').masonry();
        </script>

        <script src="assets/js/jquery.sliderPro.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function ($) {
                $('#example3').sliderPro({
                    width: 960,
                    height: 200,
                    fade: true,
                    arrows: false,
                    buttons: true,
                    fullScreen: false,
                    shuffle: true,
                    smallSize: 500,
                    mediumSize: 1000,
                    largeSize: 3000,
                    thumbnailArrows: true,
                    autoplay: false,
                    thumbnailsContainerSize: 960

                });
            });
        </script>
        <script src="assets/js/plugins.js"></script>
        <script src="assets/js/main.js"></script>

    </body>
</html>
