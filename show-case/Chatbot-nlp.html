
<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Zidong Xu - personal website - NLP</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">

        <!--Google fonts links-->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">


        <link rel="stylesheet" href="assets/css/fonticons.css">
        <link rel="stylesheet" href="assets/css/slider-pro.css">
        <!--<link rel="stylesheet" href="assets/css/stylesheet.css">-->
        <link rel="stylesheet" href="assets/css/font-awesome.min.css">
        <link rel="stylesheet" href="assets/css/bootstrap.min.css">


        <!--For Plugins external css-->
        <link rel="stylesheet" href="assets/css/plugins.css" />

        <!--Theme custom css -->
        <link rel="stylesheet" href="assets/css/style.css">

        <!--Theme Responsive css-->
        <link rel="stylesheet" href="assets/css/responsive.css" />

        <script src="assets/js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
    </head>

    <body data-spy="scroll" data-target=".navbar-collapse">
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <div class='preloader'><div class='loaded'>&nbsp;</div></div>
        <header id="main_menu" class="header navbar-fixed-top">            
            <div class="main_menu_bg">
                <div class="container">
                    <div class="row">
                        <div class="nave_menu">
                            <nav class="navbar navbar-default" id="navmenu">
                                <div class="container-fluid">
                                    <!-- Brand and toggle get grouped for better mobile display -->
                                    <div class="navbar-header">
                                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                                            <span class="sr-only">Toggle navigation</span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                            <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="index.html">
                                            <img src="assets/images/logo.png" width="70" height="40"/>
                                        </a>
                                    </div>

                                    <!-- Collect the nav links, forms, and other content for toggling -->

                                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                                        <ul class="nav navbar-nav navbar-right">
                                            <li><a href="aboutus.html">About me</a></li>
                                            <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true">Projects</a>
                                                <ul class="dropdown-menu">
                                                    <li><a href="NLP.html">Natural Language Processing</a></li>
                                                    <li><a href="service1.html">Neural Nets and Deep Learning</a></li>
                                                    <li><a href="service1.html">Big Data and Cloud Computing</a></li>
                                                    <li><a href="service1.html">Data Science and Analytics</a></li> 
                                                </ul>
                                            </li>
                                            <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true">Blog</a>
                                                <ul class="dropdown-menu">
                                                    <li><a href="blog.html">blog page</a></li>
                                                    <li><a href="bloginner.html">singleblog page</a></li>
                                                </ul>
                                            </li>
                                            <li><a href="resume.html">Resume</a></li>
                                            <li><a href="contact.html">Contact</a></li>
                                        </ul>    
                                    </div>
                                </div>
                            </nav>
                        </div>	
                    </div>

                </div>

            </div>
        </header> <!--End of header -->



        <!-- Blog Section -->
        <section id="bloginner" class="bloginner sections margin-top-120">
            <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="head_title text-center">
                            <h3>Finetuned DialoGPT on Movie Dialogues </h3>

                            <h5>9 December 2022</h5>
                            Authors: Minglei Cai, Jieqian Liu, Jieyi Sun, Zidong Xu

                        </div><!-- End of head title -->
                        <div class="main_bloginner_area">
                            <div class="row">
                                <div class="col-sm-10 col-sm-offset-1">
                                    <div class="main_bloginner_content">
                                        <div class="single_bloginner s_blogIner_1 text-center">
                                            <img src="assets/images/nlp-images/introduction.png" alt="" height="350"/>
                                        </div><!-- End of single single_bloginner -->

                                        <div class="single_bloginner s_blogIner_2 margin-top-80">
                                            <div class="separator2"></div>
                                            <p>Chatbots generally represent for the software applications which can carry out live conversations with users' utterances in the form of text or audio. While a lot of research has been done on chatbots for the theories and engineering techniques, a number of chatbot applications have been also developed in different settings. The chatbots could be divided into different categories according to the usage and principles behind, among which some popular ones are: </p>

                                            <ul>
                                                <li><strong>Customer Service Chatbots:</strong> Carry out Q&As and provide service options
                                                for the customers. Typical examples are customer service chatbots of e-commerce companies,
                                                such as Amazon and Ebay.</li>
                                                <br>
                                                <li><strong>Task Oriented Chatbots:</strong> Answer questions and have the ability to
                                                  complete specific tasks, such as scheduling appointments and making calls. 
                                                  Two typical examples are Siri from Apple and Cortana from Microsoft.</li>
                                                <br>
                                                <li><strong>Open Domain Chatbots:</strong> Chat with users in turns in an open domain, not 
                                                restricted to specific tasks, sometimes within certain topics. </li>
                                              </ul>
                                            

                                        </div>

                                        <div class="single_bloginner s_blogIner_3 margin-top-60">
                                            <h4>Project Goals</h4>
                                            <br>

                                            <p>For our project, we place our interests and efforts on the open-domain chatbots. We expect to build an open-domain chatbot with dramatic responses, which has the ability of 'chatting' with the user in an interesting and interactive way. </p>

                                            <p>
                                                Our basic idea is first load the open-source pre-trained models of DialoGPT, which are from microsoft and trained primarily on twits and reddits. Then we finetune the model on the movie dialogue corpus, in the assumption that conversations in movies tend to be more dramatic and emotional, different from common conversations with more apparent features that is easy for us to build models, specifically tweets and reddits. We finally deploy the chatbots using google voice API. More technical details are provided in the following parts. </p>

                                            <p>	Our business goal is to give the user a surprise, a sense of happiness, and a relief temporarily from the heavy everyday work and studies. </p>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12">
                                <div class="single_bloginner s_blogIner_4 single_bloginner_bottom_heading margin-top-80">
                                    <div class="separator2"></div>
                                    <h4>Tutorial </h4>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-10 col-sm-push-1">
                                    <div class="single_bloginner s_blogIner_5 margin-top-60">
                                        <p><strong>Pre-trained Model </strong>: <strong>DialoGPT</strong> from <strong>microsoft</strong></p>
                                        <p>Model link from <strong>huggingface</strong>: <a href="https://huggingface.co/microsoft/DialoGPT-medium">microsoft/DialoGPT</a></p>
                                        
                                        <ul>
                                            <p>
                                             The DialoGPT was released by Microsoft and trained with 147M multi-turn dialogues extracted from Reddit discussion threads. It has strong flexibility and robustness. As an autoregressive (AR) language model which uses a multi-layer transformer as its model architecture, it establishes a foundation for building versatile open-domain chatbots which can deliver engaging and natural conversational responses across various topics, tasks, and information requests, without resorting to heavy hand-crafting.
                                            </p>
                                              
                                            <p>
                                              According to the human evaluation results, the response generated from DialoGPT is comparable to human response quality under a single-turn conversation Turing test.
                                            </P>

                                            <div class="single_bloginner s_blogIner_1 text-center">
                                                <img src="assets/images/nlp-images/pretrain_model_evaluation.png" alt="" width="500" height="150"/>
                                            </div>

                                        </ul>
                                        <br>
                                        <hr>

                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>DataSet</strong>
                                        </h3>
                                            <br>
                                                <p>
                                                  <strong> Dataset overview: </strong>
                                                </p>

                                                <div class="single_bloginner s_blogIner_1 text-center">
                                                <img src="assets/images/nlp-images/dataset_overview.png" alt="" width="700" height="350"/>
                                                </div>
                                                <br><br>
                                         
                                                <p>
                                                  The <strong>Movie Dialogue Corpus</strong> contains a metadata-rich collection of fictional conversations extracted from raw movie scripts:
                                                   <a href="https://www.kaggle.com/datasets/Cornell-University/movie-dialog-corpus">movie-dialog-corpus-kaggle-link</a>
                                                </p>
                                            
                                                <p>
                                                This dataset only includes movies that had more than 5 IMDB (The Internet Movie Database; data interfaces available at http://www.imdb.com/interfaces) votes, which includes 220,579 conversational exchanges between 10,292 pairs of movie characters, 9,035 characters from 617 movies, and a totally of 304,713 utterances.
                                                </P>
                                                <br>

                                                <p>
                                                  <strong>Data Cleaning</strong>
                                                </p>
                                                <p>
                                                    First, we joined tables and got all the conversations in movies tagged by ‘comedy’, and then we use Regular expressions to remove unnecessary symbols from the actual text of each utterance we extracted before.
                                                </P>
                                                <p>
                                                    What's more, we found that there are too many repeated sentences like ‘Yes’, ‘No’, ‘I don’t know’, ‘I’m sorry’ in our training data sets. 
                                                    To avoid the situation the chatbot respond too many such words to users instead of humorous responses, 
                                                    we removed these superfluous words from our training dataset. 
                                                </P>
                                                <p>
                                                    In experiments of interacting with this chatbot, we found that it tends to give very short response. 
                                                    Since the business goal of this chatbot is to help users to pass the time away and gives users entertainment, 
                                                    such short conversations are not wanted by users. Therefore, we filtered out all sentences with length under 10.
                                                </P>
                                        
                                        <br>
                                        <hr>
                                     
                                    
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Fine-tuning</strong>
                                        </h3>
                                            <br>
                                                <p>
                                                  <strong>Hardware Support for Training:</strong>
                                                </p>
                                                
                                                <ul>
                                                  <li>
                                                    &#9749; To adjust the chatbot precisely so as to bring to the highest level of performance and effective, 
                                                    the hardware support we chose for training is Colab Pro+ with 800 compute units which cost us $80 per month. 
                                                  </li>
                                                  <li>
                                                    &#9749; To ensure that we have enough cloud storage, we used Google One with 100 GB storage which cost us $2 per month.  
                                                  </li>
                                                  <li>
                                                    &#9749; We used benchmarks of Intel Core i7-10750H with RAM 16GB which is one of the fastest laptop processors on the market. 
                                                  </li>
                                                </ul>
                                                <br>

                                                <p>
                                                  <strong>Finetuning Time: </strong>(Epochs:2 Batch_size:4)
                                                </p>
                                                <p>
                                                    DialoGPT is a SOTA large-scale pretrained dialogue response generation model for nultiturn conversations. 
                                                    In the human evaluation, we have used three DialoGPT with different size and compare the time of response generated from DialoGPT. 
                                                
                                                    We waited around 35 minutes for DialoGPT-small (0.5 GB) to respond, 
                                                    80 minutes for DialoGPT-medium (1.4 GB) to respond, 135 minutes for DialoGPT-large (2.9 GB) to respond.
                                                
                                                <br>
                                                <p>
                                                  <strong>Training Loss Visualization: </strong>(Screenshots of Tensorboard)
                                                </p>
                                                <table>
                                                  <tr>
                                                    <td>
                                                    <div class="single_bloginner s_blogIner_1 text-center">
                                                        <img src="assets/images/nlp-images/loss-small.jpg" alt="" width="400" height="250"/>
                                                    </div>
                                                    </td>

                                                    <td>
                                                    <div class="single_bloginner s_blogIner_1 text-center">
                                                        <img src="assets/images/nlp-images/loss-large.jpg" alt="" width="400" height="250"/>
                                                    </div>
                                                    </td>
                                                  </tr>                  
                                                </table>
                                                <br><br>
                                                <div class="single_bloginner s_blogIner_1 text-center">
                                                        <img src="assets/images/nlp-images/loss-medium.jpg" alt="" width="600" height="350"/>
                                                </div>
                                                <br><br>
                                               
                                                   
                                                <ul>
                                                  <li>
                                                    We use the training loss as part of our standards for the hyper-parameter selection.
                                                  </li>
                                                  <li>
                                                    We have trials of the small-size models to find a roughly appropriate range
                                                    for the learning rate. We also test the trick of clipping gradient norms in this
                                                    setting. According to the loss, it's better to clip the gradients.
                                                  </li>
                                                  <li>
                                                    We give only one trial to the large-size model, considering the time and cost.
                                                  </li>
                                                  <li>
                                                    We place our focus on the medium-size models. According to the loss plot, we
                                                    can see that 2 epochs is enough. From these finetuning processes, we get different
                                                    examples of models, which could be deployed later.
                                                  </li>
                                                </ul>
                                        <br>
                                        <hr>
                                    
                                    
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Deploy</strong>
                                        </h3>
                                        <br>
                                                <p>
                                                    We used Google Voice API to receive messages, autosave messages to gmail. 
                                                    Then processed unread messages every 5 seconds, using our models. 
                                                    Finally sent processed messages through our virtual number (+1 2028884948). 
                                                    All messages were processed in different sessions which are classified by sender numbers.
                                                </P>
                                                <p>
                                                    Since there were no extra machines nor rent any servers, 
                                                    we deployed our models just on Google Colab. 
                                                    Considering the price of google colab, it is not 24-hour deployed, only running when we want to make interactions with our chatbot.
                                                </P>          
                                        <br>
                                        <hr>
                                    
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Demo</strong>
                                        </h3>
                                        <br>

                                        <p>Let's see a demo first.</p>
                                        <div class="row py-5">
                                        
                                          <div class="col-md-12">
                                            <div class="card p-0" style="border: none">
                                              <video width="400" height="230" style="margin:auto;" controls >
                                                <source src="demos/demo1.mp4"  type="video/mp4">
                                                Your browser does not support the video tag.
                                              </video>
                                              
                                            </div>
                                          </div>
                                        </div>
                                        <br>
                                        <p>Going through a testing phrase before releasing our chat robot is quite important. 
                                          We must keep on monitoring results even after going live. 
                                          We have performed many experiments using models of different size and training data sets. 
                                          Finally, we got a satisfying chatbot whose name is SweetHeart. 
                                          SweetHeart was implemented with DialoGPT-medium and the dataset after cleaning.</p>
                                    
                                        <br>
                                        <hr>
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>More Interactions</strong>
                                        </h3>
                                        <br>

                                        <p>After improving the data-cleaning process and finetuning process and having more trails for the hyper-parameters, 
                                          our SweetHeart became more humorous and interactive. Here are more interesting interaction with our SweetHeart.:</p>
                                    
                                        <table style="margin:auto;">
                                          <tr>
                                            <td>
                                              <div class="single_bloginner s_blogIner_1 text-center">
                                                <img src="assets/images/nlp-images/Screenshot1.jpg" alt="" width="200" height="400"/>
                                              </div>
                                            </td>
                                    
                                            <td>
                                              <div class="single_bloginner s_blogIner_1 text-center">
                                                    <img src="assets/images/nlp-images/Screenshot2.jpg" alt="" width="200" height="400"/>
                                              </div>
                                            </td>
                                          </tr>
                                        </table>
                            
                                        <br><br>
                                        <p>
                                          We interacted with our SweetHeart using common sentences, philosophical questions, quotes of Darks Souls & 
                                          Elden Ring, poems by Load Byron. And in reply our SweetHeart presented us with some surprises!
                                        <br><br>

                                          While original DialoGPT tends to give longer replies as illustrations to the question 
                                          'What's the meaning of Life?', this chatbot tends to reply in a short and smarter way, which 
                                          is expected in movie conversations.
                                        </p>
                                        <br>
                                        <hr>
                                    
                                    
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Conclusions</strong>
                                        </h3>
                                        <br>
                                        <p>
                                          Above is all about our NLP final project regarding building a chatbot. 
                                          Although our SweetHeart chatbot interacts with us as what we've expected, 
                                          more complex structures and more advanced techniques can be applied to our chatbot in the future.
                                        </p>
                                        <p>
                                          There is a famous and instructive quote from <strong>Dr. Seuss</strong>:
                                        </p>
                                        <p style="font-family: cursive;">
                                           The more that you read, the more things you will know.<br>
                                            The more that you learn, the more places you’ll go.
                                        </p>
                                        <p>
                                          While our chatbot has learned from the movie conversations, 
                                          it is expected that it can learn from daily conversations which have less features and interacted as real. 
                                          We ourselves also need to keep learning from more papers and applications, 
                                          in the hope to improve our lovely chatbot and build more interesting and elegant models in the future.
                                        </p>
                                        <br>
                                        <hr>
                                    
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Future Work</strong>
                                        </h3>
                                        <br>
                                        <p> 
                                          There are still some goals we need to achieve in the future to improve the performance of our model. 
                                          For the method we used this time, it simply shuffles the training dataset. 
                                          It may perform much better if we try state-of-the-art planning strategies. 
                                          Also, if we finetune on larger datasets that balanced and explicitly in some certain utterance style, 
                                          the quality of reply of our chatbot can be higher. 
                                          The reply from our model contains a lots of adversarial or meaningless sentences. 
                                          So we need to find a solution to filter those unwanted replies.</p>
                                        <br>
                                        <hr>
                                    
                                        
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>Links</strong>
                                        </h3>
                                                <br>
                                                <ul>
                                                  <li>
                                                    <a href="https://github.com/kianakaslana648/nlp-final-project">Github Repo</a> for tutorial of data cleaning,
                                                finetuning and deploying.
                                                  </li>
                                                  <li>
                                                    <a href="https://huggingface.co/Kiana648/movie_dialogue_gpt2">Huggingface Page</a> for the finetuned model (in medium size).
                                                  </li>
                                                </ul>
                                        <br>
                                        <hr>
                                    
                                        <h3 style='font-family: "Times New Roman", Times, serif;'>
                                          <strong>References</strong>
                                        </h3>
                                        <br>
                                        <font size="-0.3">
                                            <ul>
                                                <li>
                                                <a href="https://www.microsoft.com/en-us/research/project/large-scale-pretraining-for-response-generation/">DialoGPT: Toward Human-Quality Conversational Response Generation via Large-Scale Pretraining</a> 
                                                </li>
                                                <li>
                                                <a href="https://aclanthology.org/2020.acl-demos.30.pdf">DIALOGPT : Large-Scale Generative Pre-training for Conversational Response Generation</a> 
                                                </li>
                                            </ul>  
                                        </font>   
                                        <hr>
                                        <br>


                                        
                                        <div class="work_socail transition">
                                            <a href=""><i class="fa fa-facebook img-circle"></i></a>
                                            <a href=""><i class="fa fa-twitter img-circle"></i></a>
                                            <a href=""><i class="fa fa-google-plus img-circle"></i></a>
                                            <a href=""><i class="fa fa-pinterest img-circle"></i></a>
                                            <a href=""><i class="fa fa-instagram img-circle"></i></a>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div><!-- End of col-sm-12 -->
                </div><!-- End of row -->
            </div><!-- End of Container -->
        </section><!-- End of Blog Section -->



        <!-- footer Section -->
        <footer id="footer" class="footer">
            <div class="container">
                <div class="main_footer">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="copyright_text text-center">
                                <p class=" wow fadeInRight" data-wow-duration="1s">Made with <i class="fa fa-heart"></i> by <a target="_blank" href="https://bootstrapthemes.co">Bootstrap Themes</a>2016. All Rights Reserved</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- End of container -->
        </footer><!-- End of footer -->



        <!-- START SCROLL TO TOP  -->

        <div class="scrollup">
            <a href="#"><i class="fa fa-chevron-up"></i></a>
        </div>

        <script src="assets/js/vendor/jquery-1.11.2.min.js"></script>
        <script src="assets/js/vendor/bootstrap.min.js"></script>

        <script src="assets/js/jquery.easing.1.3.js"></script>
        <script src="assets/js/masonry/masonry.min.js"></script>
        <script type="text/javascript">
            $('.mixcontent').masonry();
        </script>

        <script src="assets/js/jquery.sliderPro.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function ($) {
                $('#example3').sliderPro({
                    width: 960,
                    height: 200,
                    fade: true,
                    arrows: false,
                    buttons: true,
                    fullScreen: false,
                    shuffle: true,
                    smallSize: 500,
                    mediumSize: 1000,
                    largeSize: 3000,
                    thumbnailArrows: true,
                    autoplay: false,
                    thumbnailsContainerSize: 960

                });
            });
        </script>
        <script src="assets/js/plugins.js"></script>
        <script src="assets/js/main.js"></script>

    </body>
</html>
